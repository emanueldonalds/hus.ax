<script src=\"https://unpkg.com/htmx.org@1.9.12\"></script><style>\n        body {\n          display: flex;\n          max-width: 2vw;\n        }\n\n      #search {\n        display: flex;\n        flex-direction: column;\n        margin-right: 20px;\n      }\n\n      input, select {\n        margin-bottom: 10px;\n      }\n\n      .sortable {\n        color: inherit;\n        text-decoration: none;\n      }\n      .sortable:visited {\n        color: inherit;\n      }\n      .sortable:hover {\n        color: gray;\n      }\n\n      .tableHeader {\n        justify-content: top;\n      }\n    </style><html><head></head><body><form id=\"search\" action=\"/\"><h1>Hus.ax</h1><label for=\"agency\">Agency</label> <select id=\"agency\" name=\"agency\"><option value=\"\">All</option> <option>MÃ¤klarhuset</option> <option>Lyyski</option> <option>Aktia LKV</option> <option>Din Fastighet</option></select> <label for=\"price_min\">Price min</label> <input id=\"price_min\" name=\"price_min\" type=\"number\"> <label for=\"price_min\">Price max</label> <input id=\"price_max\" name=\"price_max\" type=\"number\"> <label for=\"year_min\">Year min</label> <input id=\"year_min\" name=\"year_min\" type=\"number\"> <label for=\"year_max\">Year max</label> <input id=\"year_max\" name=\"year_max\" type=\"number\"> <label for=\"size_value_min\">Area min</label> <input id=\"size_value_min\" name=\"size_value_min\" type=\"number\"> <label for=\"size_value_max\">Area max</label> <input id=\"size_value_max\" name=\"size_value_max\" type=\"number\"> <label for=\"price_over_area_min\">Price/Area min</label> <input id=\"price_over_area_min\" name=\"price_over_area_min\" type=\"number\"> <label for=\"price_over_area_max\">Price/Area max</label> <input id=\"price_over_area_max\" name=\"price_over_area_max\" type=\"number\"> <label for=\"include_deleted\">Include deleted</label> <input id=\"include_deleted\" name=\"include_deleted\" type=\"checkbox\" value=\"true\"> <input type=\"hidden\" id=\"order_by\" name=\"order_by\"> <input type=\"hidden\" id=\"sort_order\" name=\"sort_order\"> <button type=\"submit\">Search</button></form><div id=\"result\"></div><table style=\"width: 100%;white-space: nowrap;\"><thead><tr class=\"tableHeader\"><th><a class=\"sortable\" href=\"#\" onclick=\"sort(&#39;address&#39;)\">Address</a></th><th><a class=\"sortable\" href=\"#\" onclick=\"sort(&#39;price&#39;)\">Price</a></th><th><a class=\"sortable\" href=\"#\" onclick=\"sort(&#39;size_value&#39;)\">Area</a></th><th><a class=\"sortable\" href=\"#\" onclick=\"sort(&#39;price_over_area&#39;)\">Price/m2</a></th><th><a class=\"sortable\" href=\"#\" onclick=\"sort(&#39;rooms&#39;)\">Rooms</a></th><th><a class=\"sortable\" href=\"#\" onclick=\"sort(&#39;year&#39;)\">Year</a></th><th>Previous price</th><th><a class=\"sortable\" href=\"#\" onclick=\"sort(&#39;first_seen&#39;)\">First seen</a></th><th><a class=\"sortable\" href=\"#\" onclick=\"sort(&#39;agency&#39;)\">Agency</a></th><th><a class=\"sortable\" href=\"#\" onclick=\"sort(&#39;url&#39;)\">Url</a></th></tr></thead> <tbody style=\"font-size: 12px;\">
<tr><td>
</td><td>
</td><td>
 
</td><td>
</td><td>
</td><td>
</td><td>
</td><td>
</td><td>
</td><td><a href=\"
\">
</a></td></tr>
</tbody></table></body></html><script>\n        // On initial load stuff\n\n        const agencyName = \"agency\"\n        const priceMinName = \"price_min\";\n        const priceMaxName = \"price_max\";\n        const yearMinName = \"year_min\";\n        const yearMaxName = \"year_max\";\n        const areaMinName = \"size_value_min\";\n        const areaMaxName = \"size_value_max\";\n        const priceOverAreaMinName = \"price_over_area_min\";\n        const priceOverAreaMaxName = \"price_over_area_max\";\n        const includeDeletedName = \"include_deleted\";\n        const orderByName = \"order_by\";\n        const sortOrderName = \"sort_order\";\n\n        const query = window.location.search;\n        const params = new URLSearchParams(query);\n\n        const agency = params.get(agencyName) ?? '';\n        const priceMin = params.get(priceMinName);\n        const priceMax = params.get(priceMaxName);\n        const yearMin = params.get(yearMinName);\n        const yearMax = params.get(yearMaxName);\n        const areaMin = params.get(areaMinName);\n        const areaMax = params.get(areaMaxName);\n        const priceOverAreaMin = params.get(priceOverAreaMinName);\n        const priceOverAreaMax = params.get(priceOverAreaMaxName);\n        const includeDeleted = params.get(includeDeletedName);\n        const orderBy = params.get(orderByName);\n        const sortOrder = params.get(sortOrderName);\n\n        document.getElementById(agencyName).value = agency;\n        document.getElementById(priceMinName).value = priceMin;\n        document.getElementById(priceMaxName).value = priceMax;\n        document.getElementById(yearMinName).value = yearMin;\n        document.getElementById(yearMaxName).value = yearMax;\n        document.getElementById(areaMinName).value = areaMin;\n        document.getElementById(areaMaxName).value = areaMax;\n        document.getElementById(priceOverAreaMinName).value = priceOverAreaMin;\n        document.getElementById(priceOverAreaMaxName).value = priceOverAreaMax;\n        document.getElementById(includeDeletedName).checked = includeDeleted === \"true\";\n        document.getElementById(orderByName).value = orderBy;\n        document.getElementById(sortOrderName).value = sortOrder;\n\n\n        // Interactive stuff\n\n        let searchForm = document.getElementById('search');\n\n        // Remove all empty form fields from the GET query\n        window.addEventListener('load', function() {\n            searchForm.addEventListener('formdata', function(event) {\n              let formData = event.formData;\n              for (let [name, value] of Array.from(formData.entries())) {\n                if (value === '') formData.delete(name);\n              }\n            });\n        });\n\n        // Add sort_by and sort_order query parameters and submit the search form\n        function sort(field) {\n            const orderByInput = document.getElementById('order_by')\n            const sortOrderInput = document.getElementById('sort_order')\n\n            orderByInput.value = field;\n\n            if (orderByInput.value === field) {\n                sortOrderInput.value = sortOrderInput.value === \"desc\" ? \"asc\" : \"desc\";\n            }\n            else {\n                sortOrderInput.value = \"desc\";\n            }\n            searchForm.submit();\n        }\n    </script>
